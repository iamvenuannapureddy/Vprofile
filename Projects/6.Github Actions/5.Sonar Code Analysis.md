### Step-by-Step Guide: Setting Up SonarCloud Integration in GitHub Actions

---

#### **1. Objective**  
To configure and execute SonarCloud code analysis using GitHub Actions for CI/CD pipelines.

---

### Prerequisites  

1. **Sign Up for SonarCloud**  
   - Complete the registration process at [SonarCloud](https://sonarcloud.io/).  
   - Use your GitHub account to log in.  

2. **Create Organization and Project on SonarCloud**  
   - Click the **plus (+)** symbol in SonarCloud and select **Create New Organization**.  
   - Provide a unique name for the organization (e.g., `Profile21`).  
   - Set the organization key (e.g., `profile_21`) â€” **this must be unique**.  
   - Select the **Free Plan** and create the organization.  

3. **Create a Project**  
   - In your organization, click **Analyze New Project**.  
   - Name the project and assign it a unique project key (e.g., `actions_code`).  
   - Choose the **public** option to avoid private plan charges.  
   - Click **Next** and **Create Project**.  

---

### Secrets Configuration in GitHub  

#### **Step 1: Generate SonarCloud Token**  
1. Go to **My Account > Security** in SonarCloud.  
2. Generate a new token:  
   - Provide a name (e.g., `GitHubActions`).  
   - Click **Generate Token**.  
3. Copy and save the token securely (e.g., in a sticky note or password manager).

#### **Step 2: Save Secrets in GitHub**  
1. Navigate to the **Settings** tab in your GitHub repository.  
2. Scroll down to **Secrets and Variables > Actions**.  
3. Add the following secrets:  
   - **`SONAR_URL`**: `https://sonarcloud.io`  
   - **`SONAR_TOKEN`**: (Paste your generated SonarCloud token)  
   - **`SONAR_ORGANIZATION`**: The unique organization key (e.g., `profile_21`).  
   - **`SONAR_PROJECT_KEY`**: The unique project key (e.g., `actions_code`).  

---

### Configure GitHub Actions Workflow

#### **Step 1: Ensure Java 11 Installation**  
Sonar Scanner requires Java 11. Use the GitHub Marketplace action `actions/setup-java` to configure Java:  
```yaml
- name: Setup Java 11
  uses: actions/setup-java@v3
  with:
    distribution: 'temurin'  # Java distribution by Eclipse
    java-version: '11'
```

#### **Step 2: Install Sonar Scanner**  
Use the `SonarSource/sonarcloud-github-action` from GitHub Marketplace to set up Sonar Scanner:  
```yaml
- name: Install Sonar Scanner
  uses: SonarSource/sonarcloud-github-action@v2
```

#### **Step 3: Run Sonar Scanner**  
Add a step to execute the Sonar Scanner command and analyze the source code:  
```yaml
- name: Run Sonar Analysis
  run: |
    sonar-scanner \
      -Dsonar.host.url=${{ secrets.SONAR_URL }} \
      -Dsonar.login=${{ secrets.SONAR_TOKEN }} \
      -Dsonar.organization=${{ secrets.SONAR_ORGANIZATION }} \
      -Dsonar.projectKey=${{ secrets.SONAR_PROJECT_KEY }} \
      -Dsonar.sources=src \
      -Dsonar.java.binaries=target/classes \
      -Dsonar.checkstyle.reportPaths=target/checkstyle-result.xml
```

---

### Test the Workflow

#### **Step 1: Save and Push Changes**  
1. Save the changes to your `.github/workflows/main.yml` file.  
2. Commit and push the updates:  
   ```bash
   git add .github/workflows/main.yml
   git commit -m "SonarCloud code analysis workflow"
   git push origin main
   ```

#### **Step 2: Run Workflow**  
1. Go to the **Actions** tab in your GitHub repository.  
2. Select the workflow and click **Run Workflow**.  
3. Monitor the logs for each step:  
   - **Setup Java 11**  
   - **Install Sonar Scanner**  
   - **Run Sonar Analysis**  

---

### Key Notes  
1. **Sonar Scanner Dependency**: Ensure all paths (e.g., source and binary paths) match your project structure.  
2. **Secrets**: Once saved, secrets are encrypted and cannot be viewed again. Only GitHub Actions workflows can access them.  
3. **Marketplace Resources**: GitHub Marketplace provides pre-verified tools for streamlining CI/CD workflows.  

This concludes the configuration and execution of SonarCloud integration in GitHub Actions.
